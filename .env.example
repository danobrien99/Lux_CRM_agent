# Core runtime
ENVIRONMENT=dev
API_PREFIX=/v1

# Data stores
NEON_PG_DSN=postgresql://neondb_owner:...
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=40
DB_POOL_TIMEOUT_SECONDS=60
DB_POOL_RECYCLE_SECONDS=1800
# Local Neo4j default for docker-compose.
NEO4J_URI=neo4j://neo4j:7687
# If running API outside Docker, use neo4j://localhost:7687.
NEO4J_USER=neo4j
NEO4J_PASSWORD=changeme
NEO4J_HTTP_PORT=7474
NEO4J_BOLT_PORT=7687
REDIS_URL=redis://redis:6379/0

# Security
N8N_WEBHOOK_SECRET=replace-with-long-random-string
N8N_PORT=5679
BACKFILL_POST_BATCH_SIZE=20
BACKFILL_POST_PAUSE_MS=250
BACKFILL_POST_TIMEOUT_MS=120000

# Contact registry
GOOGLE_SHEETS_ID=
GOOGLE_SHEETS_SERVICE_ACCOUNT_JSON=
GOOGLE_SHEETS_RANGE=Contacts!A:Z

# LLM / embeddings
OPENAI_API_KEY=
LLM_PROVIDER=openai
LLM_MODEL=gpt-4o-mini
EMBEDDING_PROVIDER=openai
EMBEDDING_MODEL=text-embedding-3-small
EMBEDDING_DIM=1536

# Cognee integration (open-source local default)
COGNEE_BACKEND=local
COGNEE_LOCAL_MODULE=app.integrations.cognee_oss_adapter
COGNEE_LOCAL_FUNCTION=extract_candidates
COGNEE_REPO_PATH=../Third_Party/cognee
COGNEE_DATASET_NAME=lux_crm
COGNEE_SEARCH_TYPE=GRAPH_COMPLETION
COGNEE_SEARCH_TOP_K=8
COGNEE_LOCAL_TIMEOUT_SECONDS=120
# Set true only for local dev rescue mode; production should remain false.
COGNEE_ENABLE_HEURISTIC_FALLBACK=false
# Optional fallback if running Cognee as a local HTTP service
COGNEE_ENDPOINT=

# Mem0 integration (open-source local default)
MEM0_BACKEND=local
MEM0_LOCAL_MODULE=app.integrations.mem0_oss_adapter
MEM0_LOCAL_FUNCTION=propose_memory_ops
MEM0_REPO_PATH=../Third_Party/mem0
MEM0_COLLECTION_NAME=lux_crm_memories
MEM0_GRAPH_DATABASE=neo4j
MEM0_AGENT_ID=lux_crm_agent
MEM0_SEARCH_LIMIT=25
MEM0_LOCAL_TIMEOUT_SECONDS=120
# Set true only for local dev rescue mode; production should remain false.
MEM0_ENABLE_RULES_FALLBACK=false
# Optional fallback if running Mem0 as a local HTTP service
MEM0_ENDPOINT=

# Ontology mapping config (controls canonical claim/predicate/entity mapping)
ONTOLOGY_CONFIG_PATH=app/services/ontology/ontology_config.json

# Queue behavior: redis or inline
QUEUE_MODE=redis
QUEUE_RETRY_MAX=2
QUEUE_RETRY_INTERVAL_SECONDS=60

# Graph V2 (CRM/Case/Evidence)
GRAPH_V2_ENABLED=true
GRAPH_V2_DUAL_WRITE=false
GRAPH_V2_READ_V2=true
GRAPH_V2_CASE_OPPORTUNITY_THRESHOLD=0.68
GRAPH_V2_CASE_CONTACT_PROMOTION_MIN_EVIDENCE=2
GRAPH_V2_CASE_CONTACT_PROMOTION_MAX_AGE_DAYS=180
GRAPH_V2_INFERENCE_MIN_CONFIDENCE=0.85
GRAPH_V2_INFERENCE_MAX_AGE_DAYS=180
INTERNAL_EMAIL_DOMAINS=luxcrm.ai
INTERNAL_USER_EMAILS=

# SHACL / n10s validation
SHACL_VALIDATION_ENABLED=true
SHACL_VALIDATION_ON_WRITE=true

# Cleanup policy
DATA_CLEANUP_ENABLED=true
DATA_CLEANUP_SCHEDULE_CRON=0 3 * * *
DATA_RETENTION_RAW_DAYS=180
DATA_RETENTION_CHUNKS_DAYS=365
DATA_RETENTION_DRAFTS_DAYS=365

# Memory thresholds
AUTO_ACCEPT_THRESHOLD=0.90

# Optional: use LLM scoring for relationship warmth/depth from message content
SCORING_USE_LLM_WARMTH_DEPTH=false
SCORING_LLM_MAX_INTERACTIONS=8
SCORING_LLM_SNIPPET_CHARS=280

# Interaction summary cache
INTERACTION_SUMMARY_CACHE_ENABLED=true
INTERACTION_SUMMARY_CACHE_TTL_SECONDS=21600
